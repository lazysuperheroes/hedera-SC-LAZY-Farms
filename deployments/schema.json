{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://lazysuperheroes.com/schemas/deployment-manifest.json",
  "title": "Lazy Farms Deployment Manifest",
  "description": "Schema for tracking deployed contracts in the Lazy Superheroes farming system",
  "type": "object",
  "required": ["network", "chainId", "version", "contracts"],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference"
    },
    "network": {
      "type": "string",
      "enum": ["mainnet", "testnet", "previewnet", "local"],
      "description": "Hedera network identifier"
    },
    "chainId": {
      "type": "integer",
      "description": "EVM chain ID (295 for mainnet, 296 for testnet)",
      "enum": [295, 296, 297, 298]
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version of the deployment"
    },
    "deployedAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of initial deployment"
    },
    "deployer": {
      "type": "string",
      "pattern": "^0\\.0\\.\\d+$",
      "description": "Hedera account ID of deployer"
    },
    "description": {
      "type": "string",
      "description": "Human-readable description of this deployment"
    },
    "contracts": {
      "type": "object",
      "description": "Map of contract names to their deployment details",
      "additionalProperties": {
        "$ref": "#/definitions/Contract"
      }
    },
    "missions": {
      "type": "object",
      "description": "Tracking for deployed mission instances",
      "properties": {
        "_comment": { "type": "string" },
        "examples": {
          "type": "array",
          "items": { "$ref": "#/definitions/Mission" }
        }
      }
    },
    "roles": {
      "type": "object",
      "description": "Administrative role assignments",
      "properties": {
        "factoryAdmins": {
          "type": "array",
          "items": { "$ref": "#/definitions/RoleAssignment" }
        },
        "factoryDeployers": {
          "type": "array",
          "items": { "$ref": "#/definitions/RoleAssignment" }
        },
        "stakingAdmins": {
          "type": "array",
          "items": { "$ref": "#/definitions/RoleAssignment" }
        }
      }
    },
    "stakingCollections": {
      "type": "object",
      "description": "NFT collections approved for staking",
      "properties": {
        "_comment": { "type": "string" },
        "collections": {
          "type": "array",
          "items": { "$ref": "#/definitions/StakingCollection" }
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Manifest metadata",
      "properties": {
        "lastUpdated": {
          "type": "string",
          "format": "date-time"
        },
        "updatedBy": {
          "type": "string"
        },
        "solidityVersion": {
          "type": "string"
        },
        "optimizerRuns": {
          "type": "integer"
        },
        "repositoryCommit": {
          "type": "string"
        }
      }
    }
  },
  "definitions": {
    "Contract": {
      "type": "object",
      "required": ["name", "type", "contractId"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Human-readable contract name"
        },
        "type": {
          "type": "string",
          "enum": ["contract", "fungible-token", "nft-collection"],
          "description": "Type of deployed entity"
        },
        "contractId": {
          "type": "string",
          "pattern": "^0\\.0\\.\\d+$",
          "description": "Hedera contract/token ID"
        },
        "evmAddress": {
          "type": "string",
          "pattern": "^0x[a-fA-F0-9]{40}$",
          "description": "EVM address (derived from contract ID)"
        },
        "sourcePath": {
          "type": "string",
          "description": "Path to source file in repository"
        },
        "description": {
          "type": "string",
          "description": "What this contract does"
        },
        "deployedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Deployment timestamp"
        },
        "deploymentTx": {
          "type": "string",
          "description": "Transaction ID of deployment"
        },
        "verified": {
          "type": "boolean",
          "description": "Whether source is verified on explorer"
        },
        "constructorArgs": {
          "type": "object",
          "description": "Constructor arguments used",
          "additionalProperties": true
        },
        "dependencies": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Names of contracts this depends on"
        },
        "configuration": {
          "type": "object",
          "description": "Runtime configuration values",
          "additionalProperties": true
        },
        "knownIssues": {
          "type": "array",
          "items": { "$ref": "#/definitions/KnownIssue" }
        },
        "tokenInfo": {
          "type": "object",
          "description": "Token-specific information",
          "properties": {
            "symbol": { "type": "string" },
            "decimals": { "type": "integer" },
            "maxSupply": { "type": "integer" }
          }
        },
        "notes": {
          "type": "string",
          "description": "Additional notes about this deployment"
        }
      }
    },
    "Mission": {
      "type": "object",
      "required": ["name", "contractId", "deployedAt"],
      "properties": {
        "name": { "type": "string" },
        "contractId": { "type": "string" },
        "deployedAt": { "type": "string", "format": "date-time" },
        "deployedBy": { "type": "string" },
        "status": {
          "type": "string",
          "enum": ["active", "paused", "completed", "closed"]
        },
        "duration": { "type": "integer" },
        "maxParticipants": { "type": "integer" }
      }
    },
    "RoleAssignment": {
      "type": "object",
      "required": ["address"],
      "properties": {
        "address": {
          "type": "string",
          "pattern": "^0\\.0\\.\\d+$"
        },
        "name": { "type": "string" },
        "addedAt": { "type": "string", "format": "date-time" },
        "addedBy": { "type": "string" },
        "transactionId": { "type": "string" }
      }
    },
    "StakingCollection": {
      "type": "object",
      "required": ["tokenId"],
      "properties": {
        "tokenId": { "type": "string" },
        "name": { "type": "string" },
        "maxRewardRate": { "type": "integer" },
        "addedAt": { "type": "string", "format": "date-time" }
      }
    },
    "KnownIssue": {
      "type": "object",
      "required": ["type", "description"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["typo", "gas-inefficiency", "limitation", "bug"]
        },
        "description": { "type": "string" },
        "severity": {
          "type": "string",
          "enum": ["cosmetic", "minor", "moderate", "critical"]
        },
        "workaround": { "type": "string" }
      }
    }
  }
}
